(()=>{"use strict";var e={23:function(e,t,n){var o,i=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||(o=function(e){return o=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},o(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=o(e),r=0;r<n.length;r++)"default"!==n[r]&&i(t,e,n[r]);return a(t,e),t}),s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,a){function r(e){try{l(o.next(e))}catch(e){a(e)}}function s(e){try{l(o.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(r,s)}l((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const l=r(n(414)),d=window.PluginApi,{React:c}=window.PluginApi,{Button:u,ButtonGroup:g,Card:p}=d.libraries.Bootstrap,{faArrowUp:h,faArrowDown:m,faTrash:f}=d.libraries.FontAwesomeSolid,{Icon:v,LoadingIndicator:E}=d.components;class T extends c.Component{constructor(e){super(e),this.loadData=()=>{this.setState({loading:!0},()=>l.getTags().then(e=>{this.setState({tags:e,loading:!1})}))},this.onUpClicked=()=>{this.props.onUp&&this.props.onUp()},this.onDownClicked=()=>{this.props.onDown&&this.props.onDown()},this.onRemoveClicked=()=>{this.props.onRemove&&this.props.onRemove()},this.onNameChanged=e=>{this.setState({name:e,changed:!0})},this.onConditionChanged=e=>{this.setState({conditionTagId:e,changed:!0})},this.onFocusLost=()=>{this.state.changed&&this.props.onChanged&&this.props.onChanged(this.state.name,this.state.conditionTagId)},this.state={loading:!1,name:e.item.name,conditionTagId:e.item.conditionTagId,changed:!1}}componentDidMount(){return s(this,void 0,void 0,function*(){this.loadData()})}render(){var e;return this.state.loading?c.createElement(E,null):c.createElement(p,{className:"card-sm"},c.createElement(p.Body,null,c.createElement("div",null,c.createElement("input",{name:"name",type:"text",value:this.state.name,onChange:e=>this.onNameChanged(e.target.value),onBlur:e=>this.onFocusLost(),placeholder:"Name...",className:"form-control form-control-sm",required:!0})),c.createElement("div",null,c.createElement("select",{className:"form-control","aria-placeholder":"Selecto Tag for group condition",value:this.state.conditionTagId,onChange:e=>this.onConditionChanged(e.target.value),onBlur:e=>this.onFocusLost()},c.createElement("option",{value:""},"---No Condition---"),null===(e=this.state.tags)||void 0===e?void 0:e.map(e=>c.createElement("option",{value:e.id},e.name))))),c.createElement(p.Footer,null,c.createElement("div",{className:"row"},c.createElement("div",{className:"col-md-6"},c.createElement(g,null,this.props.onUp&&c.createElement(u,{size:"xs",onClick:this.onUpClicked},c.createElement(v,{icon:h})),this.props.onDown&&c.createElement(u,{size:"xs",onClick:this.onDownClicked},c.createElement(v,{icon:m})))),c.createElement("div",{className:"col-md-6 text-right"},this.props.onRemove&&c.createElement(u,{size:"xs",variant:"danger",onClick:this.onRemoveClicked},c.createElement(v,{icon:f}))))))}}t.default=T},221:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(409));n(264);const{PluginApi:a}=window,{React:r}=a;a.patch.after("TagSelect",function(e,t,n){return r.createElement(r.Fragment,null,n,r.createElement(i.default,Object.assign({},e)))})},264:(e,t,n)=>{n.r(t)},376:function(e,t,n){var o,i=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||(o=function(e){return o=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},o(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=o(e),r=0;r<n.length;r++)"default"!==n[r]&&i(t,e,n[r]);return a(t,e),t}),s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,a){function r(e){try{l(o.next(e))}catch(e){a(e)}}function s(e){try{l(o.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(r,s)}l((o=o.apply(e,t||[])).next())})},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const d=l(n(868)),c=r(n(414)),u=window.PluginApi,{React:g}=window.PluginApi,{Button:p,ButtonGroup:h,Card:m,Overlay:f,OverlayTrigger:v,Popover:E}=u.libraries.Bootstrap,{faGear:T}=u.libraries.FontAwesomeSolid,{Icon:C,LoadingIndicator:y}=u.components;class w extends g.Component{constructor(e){super(e),this.loadData=()=>{console.debug("loading tag groups and tag groups to tags..."),this.setState({loading:!0});const e=c.getTagGroups().then(e=>{console.debug("done loading tag groups",e),this.setState({tagGroups:e})}),t=c.getTagGroupToTags().then(e=>{console.debug("done loading tag groups to tags",e),this.setState({tagGroupsToTags:e})});return Promise.all([e,t]).then(()=>{this.setState({loading:!1})})},this.onTagClick=e=>{var t,n,o,i;let a=[];this.isTagSelected(e.id)?null===(t=this.props.values)||void 0===t||t.forEach(t=>{t.id!=e.id&&a.push(t)}):(null===(n=this.props.values)||void 0===n||n.forEach(e=>{a.push(e)}),a.push(e)),null===(i=(o=this.props).onSelect)||void 0===i||i.call(o,a)},this.isTagSelected=e=>{var t;const n=null===(t=this.props.values)||void 0===t?void 0:t.findIndex(t=>t.id==e);return void 0!==n&&n>-1},this.isTagExcluded=e=>!!this.state.excludeIds&&this.state.excludeIds.has(e),this.onSettingsClick=()=>{this.setState({showSettings:!0})},this.onSettingsClose=e=>{this.setState({showSettings:!1}),this.loadData()},this.maybeRenderSettingsDialog=()=>{if(this.state.showSettings)return g.createElement(d.default,{onClose:this.onSettingsClose})},this.renderTagPopover=e=>{var t;return g.createElement(E,{className:"hover-popover-content"},g.createElement(E.Content,{className:"tag-popover-card"},g.createElement("div",{className:"tag-card zoom-0 grid-card card"},g.createElement("div",{className:"thumbnail-section"},g.createElement("img",{loading:"lazy",className:"tag-card-image",alt:e.name,src:null!==(t=e.image_path)&&void 0!==t?t:""})),g.createElement("div",{className:"card-section"},g.createElement("h5",{className:"card-section-title flex-aligned"},e.name),g.createElement("div",{className:"tag-description"},e.description)))))},this.state={excludeIds:e.excludeIds?new Set(e.excludeIds):void 0}}componentDidMount(){return s(this,void 0,void 0,function*(){this.loadData()})}static getDerivedStateFromProps(e,t){t.excludeIds=e.excludeIds?new Set(e.excludeIds):void 0}render(){var e;return this.state.loading?g.createElement(y,null):g.createElement(g.Fragment,null,this.maybeRenderSettingsDialog(),!this.state.loading&&(null===(e=this.state.tagGroupsToTags)||void 0===e?void 0:e.filter(e=>!!e.group&&(!e.group.conditionTagId||this.isTagSelected(e.group.conditionTagId))).map(e=>{var t;return g.createElement(m,{className:"card-sm fast-tagger-card"},g.createElement(m.Header,null,null===(t=e.group)||void 0===t?void 0:t.name),g.createElement(m.Body,null,g.createElement(h,null,e.tags.map(e=>g.createElement(v,{placement:"right",delay:{show:250,hide:0},overlay:this.renderTagPopover(e)},g.createElement(p,{variant:"secondary",size:"sm",className:this.isTagSelected(e.id)?"btn-success":"",onClick:()=>this.onTagClick(e),disabled:this.isTagExcluded(e.id)},e._nameOverride?e._nameOverride:e.name))))))})),g.createElement("div",null,g.createElement(p,{className:"plugin-fast-tagger-settings-button",variant:"secondary",onClick:this.onSettingsClick},g.createElement(C,{icon:T})," Settings")))}}t.default=w},409:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(376)),a=window.PluginApi,{React:r,GQL:s}=a,{Icon:l}=a.components,{faChevronDown:d,faChevronUp:c}=a.libraries.FontAwesomeSolid;class u extends r.Component{constructor(e){super(e),this.onToggleClick=()=>{this.setState(e=>({isOpen:!e.isOpen}))},this.state={isOpen:!1}}render(){return!this.props.isMulti||!1===this.props.isClearable||!0===this.props.isDisabled||this.props.ids&&this.props.ids.length>0?r.createElement(r.Fragment,null):r.createElement(r.Fragment,null,r.createElement("div",{className:"d-flex flex-row justify-content-center"},r.createElement("div",null,r.createElement("a",{href:"javascript:void(0)",className:"plugin-fast-tagger-toggle",onClick:this.onToggleClick},!this.state.isOpen&&r.createElement(l,{icon:d}),this.state.isOpen&&r.createElement(l,{icon:c}),!this.state.isOpen&&"Open Quick Tag Editor",this.state.isOpen&&"Close Quick Tag Editor",!this.state.isOpen&&r.createElement(l,{icon:d}),this.state.isOpen&&r.createElement(l,{icon:c})))),this.state.isOpen&&r.createElement(i.default,{values:this.props.values,excludeIds:this.props.excludeIds,onSelect:this.props.onSelect}))}}t.default=u},414:function(e,t){var n=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,a){function r(e){try{l(o.next(e))}catch(e){a(e)}}function s(e){try{l(o.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(r,s)}l((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.init=p,t.applyChanges=function(){return n(this,void 0,void 0,function*(){return function(){return n(this,void 0,void 0,function*(){return window.csLib.setConfiguration("fastTagger",{groups:JSON.stringify(r),tagToGroups:JSON.stringify(l)})})}()})},t.revertChanges=function(){return n(this,void 0,void 0,function*(){return g=!1,p()})},t.resetConfig=function(){return n(this,void 0,void 0,function*(){return h()})},t.importEasyTag=function(){return n(this,void 0,void 0,function*(){return yield h(),yield p(),function(){return n(this,void 0,void 0,function*(){if(!(r.length>0))return window.csLib.getConfiguration("easytag",{Groups:"{}",Tags:"[]"}).then(e=>{if(e){const t=JSON.parse(e.Groups),n=JSON.parse(e.Tags),o=new Map;for(const e in t){const n=t[e],i={id:T(),name:n.title,order:n.order,conditionTagId:n.conditionId&&"-1"!=n.conditionId?n.conditionId:void 0};v(i),i.id&&o.set(e,i.id)}E();for(const e of n){const t=d.get(""+e.stashId);if(t&&e.group){const n=o.get(e.group);if(n){const o=s.get(n);o&&(t.groupId=o.id,t.name=e.name)}}}}})})}()})},t.getTagGroups=function(){return n(this,void 0,void 0,function*(){return yield p(),r})},t.addTagGroup=function(e){return n(this,void 0,void 0,function*(){yield p(),e.id=T(),r.length>0?e.order=r[r.length-1].order+1:e.order=1,v(e)})},t.removeTagGroup=function(e){return n(this,void 0,void 0,function*(){if(yield p(),!e.id)return;const t=r.findIndex(t=>t.id==e.id);if(!(t<0)){r.splice(t,1),s.delete(e.id);for(const t of l)t.groupId==e.id&&(t.groupId=void 0);E()}})},t.updateTagGroup=function(e,t,o){return n(this,void 0,void 0,function*(){yield p();const n=r.findIndex(t=>t.id==e.id);n<0||(r[n].name=t,r[n].conditionTagId=o)})},t.moveTagGroupUp=function(e){return n(this,void 0,void 0,function*(){yield p();const t=r.findIndex(t=>t.id==e.id);if(t<0)return;if(0==t)return;const n=r[t-1].order;r[t-1].order=r[t].order,r[t].order=n,E()})},t.moveTagGroupDown=function(e){return n(this,void 0,void 0,function*(){yield p();const t=r.findIndex(t=>t.id==e.id);if(t<0)return;if(t==r.length-1)return;const n=r[t+1].order;r[t+1].order=r[t].order,r[t].order=n,E()})},t.getTagGroupToTags=function(){return n(this,void 0,void 0,function*(){var e;yield p();const t=new Map,n=[];for(const e of r){if(!e.id)continue;const o={group:e,tags:[]};t.set(e.id,o),n.push(o)}const o={group:void 0,tags:[]};t.set("_",o),n.push(o);for(const n of l){n.groupId&&s.get(n.groupId);const o=u.get(n.tagId);if(o){const i=Object.assign({},o);i._nameOverride=n.name,i._tagGroupId=n.groupId,null===(e=t.get(n.groupId?n.groupId:"_"))||void 0===e||e.tags.push(i)}}for(const e of t.values())e.tags.sort((e,t)=>{const n=(e.sort_name?e.sort_name:"")+e.name,o=(t.sort_name?t.sort_name:"")+t.name;return n.localeCompare(o)});return n})},t.getTags=function(){return n(this,void 0,void 0,function*(){return yield p(),c})},t.moveTagToGroup=function(e,t){return n(this,void 0,void 0,function*(){const n=d.get(e.id);n&&(n.groupId=null==t?void 0:t.id)})},t.updateTag=function(e,t){return n(this,void 0,void 0,function*(){const n=d.get(e.id);n&&(n.name=t)})};const{GQL:o}=window.PluginApi,{StashService:i}=window.PluginApi.utils;let a,r=[],s=new Map,l=[],d=new Map,c=[],u=new Map,g=(new Map,!1);function p(){return n(this,void 0,void 0,function*(){if(!g)return a||(a=new Promise((e,t)=>{console.debug("initializing fast tagger data"),function(){return n(this,void 0,void 0,function*(){return r=[],s.clear(),l=[],d.clear(),window.csLib.getConfiguration("fastTagger",{groups:"[]",tagToGroups:"[]"}).then(e=>{if(e){for(var t of(r=JSON.parse(e.groups),r))t.id&&s.set(t.id,t);for(var n of(l=JSON.parse(e.tagToGroups),l))d.set(""+n.tagId,n)}})})}().then(()=>{(function(){return n(this,void 0,void 0,function*(){return c=[],u.clear(),i.queryFindTagsForSelect({makeFindFilter:()=>({sort:"name",page:1,per_page:99999}),makeFilter:()=>({})}).then(e=>{const t=e.data.findTags.tags,n=new Map(Object.keys(d).map(e=>[e,!1]));for(const e of t)m(e),n.get(e.id)&&n.delete(e.id);if(n.size>0)for(const e of Object.keys(n))f(e);c.sort((e,t)=>{const n=(e.sort_name?e.sort_name:"")+e.name,o=(t.sort_name?t.sort_name:"")+t.name;return n.localeCompare(o)})})})})().then(()=>{g=!0,a=void 0,e()})})}),a)})}function h(){return n(this,void 0,void 0,function*(){yield window.csLib.setConfiguration("fastTagger",{groups:"[]",tagToGroups:"[]"}),r=[],s.clear(),l=[],d.clear(),g=!1})}function m(e){if(c.push(e),u.set(e.id,e),!d.get(""+e.id)){const t={tagId:e.id};l.push(t),d.set(""+e.id,t)}}function f(e){const t=d.get(e);if(!t)return;const n=l.indexOf(t);l.splice(n,1),d.delete(""+e)}function v(e){e.id&&(r.push(e),s.set(e.id,e))}function E(){r.sort((e,t)=>e.order-t.order);let e=0;for(const t of r)e++,t.order=e}const T=()=>{let e="";for(;e.length<32;)e+=Math.random().toString(16).substr(2);const t=(3&parseInt(e.substr(16,1),16)|8).toString(16);return`${e.substr(0,8)}-${e.substr(8,4)}-4${e.substr(13,3)}-${t}${e.substr(17,3)}-${e.substr(20,12)}`}},436:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ModalComponent=void 0;const n=window.PluginApi,{React:o}=n,{Button:i,Modal:a,Spinner:r}=n.libraries.Bootstrap,{FormattedMessage:s}=n.libraries.Intl,l=()=>{};t.ModalComponent=({children:e,show:t,icon:n,header:d,cancel:c,accept:u,onHide:g,isRunning:p,disabled:h,modalProps:m,dialogClassName:f,footerButtons:v,leftFooterButtons:E})=>{var T,C,y,w;return o.createElement(a,Object.assign({className:"ModalComponent",keyboard:!1,onHide:null!=g?g:l,show:t,dialogClassName:f},m),o.createElement(a.Header,null,o.createElement("span",null,null!=d?d:"")),o.createElement(a.Body,null,e),o.createElement(a.Footer,{className:"ModalFooter"},o.createElement("div",null,null==E?void 0:E.map(e=>{var t,n;return o.createElement(i,{disabled:p,variant:null!==(t=e.variant)&&void 0!==t?t:"primary",onClick:e.onClick,className:"ml-2"},null!==(n=e.text)&&void 0!==n?n:o.createElement(s,{id:e.textId,defaultMessage:e.text,description:e.description}))})),o.createElement("div",null,null==v?void 0:v.map(e=>{var t,n;return o.createElement(i,{disabled:p,variant:null!==(t=e.variant)&&void 0!==t?t:"primary",onClick:e.onClick,className:"ml-2"},null!==(n=e.text)&&void 0!==n?n:o.createElement(s,{id:e.textId,defaultMessage:e.text,description:e.description}))}),c?o.createElement(i,{disabled:p,variant:null!==(T=c.variant)&&void 0!==T?T:"primary",onClick:c.onClick,className:"ml-2"},null!==(C=c.text)&&void 0!==C?C:o.createElement(s,{id:"actions.cancel",defaultMessage:"Cancel",description:"Cancels the current action and dismisses the modal."})):"",o.createElement(i,{disabled:p||h,variant:null!==(y=null==u?void 0:u.variant)&&void 0!==y?y:"primary",onClick:null==u?void 0:u.onClick,className:"ml-2"},p?o.createElement(r,{animation:"border",role:"status",size:"sm"}):null!==(w=null==u?void 0:u.text)&&void 0!==w?w:o.createElement(s,{id:"actions.close",defaultMessage:"Close",description:"Closes the current modal."})))))}},842:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=window.PluginApi,{React:o}=window.PluginApi,{Card:i,Dropdown:a}=n.libraries.Bootstrap,{LoadingIndicator:r}=n.components;let{TagLink:s}=n.components;n.utils.loadComponents([n.loadableComponents.TagLink]).then(()=>{s=n.components.TagLink});class l extends o.Component{constructor(e){super(e),this.onNameChanged=e=>{this.setState({name:e,changed:!0})},this.onFocusLost=()=>{this.state.changed&&this.props.onChanged&&this.props.onChanged(this.state.name)},this.onTagMove=e=>{this.props.onMoveTagToGroup(e)},this.state={name:e.item._nameOverride}}render(){var e;return s?o.createElement(i,{className:"card-sm fast-tagger-card"},o.createElement(i.Body,null,o.createElement("div",{className:"d-flex flex-direction-row justify-content-between align-items-center"},o.createElement("div",{className:"flex-grow-1 mr-3"},o.createElement("div",null,o.createElement(s,{tag:this.props.item,linkType:"details"})),o.createElement("div",null,o.createElement("input",{type:"text",className:"form-control form-control-sm",value:this.state.name,onChange:e=>this.onNameChanged(e.target.value),onBlur:e=>this.onFocusLost()}))),o.createElement("div",null,o.createElement(a,null,o.createElement(a.Toggle,{variant:"primary",size:"sm"},"Move to"),o.createElement(a.Menu,null,null===(e=this.props.tagGroups)||void 0===e?void 0:e.map(e=>{var t,n;if((null===(t=e.group)||void 0===t?void 0:t.id)!=this.props.item._tagGroupId)return o.createElement(a.Item,{onClick:()=>this.onTagMove(e.group)},null===(n=e.group)||void 0===n?void 0:n.name)}),this.props.tagGroups&&this.props.tagGroups.length>0&&o.createElement(a.Divider,null),o.createElement(a.Item,{onClick:()=>this.onTagMove(void 0)},"No group"))))))):o.createElement(r,null)}}t.default=l},868:function(e,t,n){var o,i=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||(o=function(e){return o=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},o(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=o(e),r=0;r<n.length;r++)"default"!==n[r]&&i(t,e,n[r]);return a(t,e),t}),s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,a){function r(e){try{l(o.next(e))}catch(e){a(e)}}function s(e){try{l(o.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(r,s)}l((o=o.apply(e,t||[])).next())})},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const d=n(436),c=l(n(842)),u=l(n(23)),g=r(n(414)),p=window.PluginApi,{React:h}=p,{Button:m,Card:f,Tabs:v,Tab:E}=p.libraries.Bootstrap,{LoadingIndicator:T}=p.components;class C extends h.Component{constructor(e){super(e),this.loadData=()=>{this.setState({loading:!0});const e=this.doLoadGroups(),t=this.doLoadTags();return Promise.all([e,t]).then(()=>{this.setState({loading:!1})})},this.loadGroups=()=>s(this,void 0,void 0,function*(){return this.setState({loading:!0}),this.doLoadGroups().then(()=>{this.setState({loading:!1})})}),this.loadTags=()=>s(this,void 0,void 0,function*(){return this.setState({loading:!0}),this.doLoadTags().then(()=>{this.setState({loading:!1})})}),this.doLoadGroups=()=>s(this,void 0,void 0,function*(){return g.getTagGroups().then(e=>{console.debug("done loading tag groups",e),this.setState({tagGroups:e})})}),this.doLoadTags=()=>s(this,void 0,void 0,function*(){return g.getTagGroupToTags().then(e=>{console.debug("done loading tag groups to tags",e),this.setState({tagGroupsToTags:e})})}),this.onTagMove=(e,t)=>{g.moveTagToGroup(e,t).then(()=>{this.loadTags()})},this.onTagChanged=(e,t)=>{g.updateTag(e,t)},this.onGroupAdd=()=>{g.addTagGroup({order:99999}).then(()=>{this.loadGroups()})},this.onClear=()=>{g.resetConfig().then(()=>{this.loadData()})},this.onGroupUp=e=>{g.moveTagGroupUp(e).then(()=>{this.loadGroups()})},this.onGroupDown=e=>{g.moveTagGroupDown(e).then(()=>{this.loadGroups()})},this.onGroupRemove=e=>{g.removeTagGroup(e).then(()=>{this.loadGroups()})},this.onGroupChanged=(e,t,n)=>{g.updateTagGroup(e,t,n).then(()=>{this.loadTags()})},this.onApply=()=>{this.setState({saving:!0}),g.applyChanges().then(()=>{this.setState({saving:!1}),this.props.onClose(!0)})},this.onCancel=()=>{this.setState({saving:!0}),g.revertChanges().then(()=>{this.setState({saving:!1}),this.props.onClose()})},this.onImportEasyTagConfig=()=>{this.setState({saving:!0}),g.importEasyTag().then(()=>{this.setState({saving:!1}),this.loadData()})},this.state={loading:!0}}componentDidMount(){return s(this,void 0,void 0,function*(){this.loadData()})}render(){var e,t;return h.createElement(d.ModalComponent,{show:!0,isRunning:this.state.loading||this.state.saving,header:"Settings",accept:{onClick:this.onApply,text:"Apply"},cancel:{onClick:this.onCancel,text:"Cancel",variant:"secondary"},modalProps:{size:"xl",dialogClassName:"scrape-dialog"},leftFooterButtons:[{text:"Clear Config",variant:"danger",onClick:this.onClear},{text:"Import from EasyTag",variant:"secondary",onClick:this.onImportEasyTagConfig}]},h.createElement(v,{defaultActiveKey:"groups",justify:!0},h.createElement(E,{eventKey:"tags",title:"Tags"},this.state.loading&&h.createElement(T,null),!this.state.loading&&(null===(e=this.state.tagGroupsToTags)||void 0===e?void 0:e.map(e=>h.createElement(f,{className:"card-sm fast-tagger-card"},h.createElement(f.Header,null,e.group?e.group.name:"Ungrouped tags"),h.createElement(f.Body,null,h.createElement("div",{className:"row"},e.tags.map(e=>h.createElement("div",{className:"col-12 col-md-6 col-lg-4"},h.createElement(c.default,{item:e,tagGroups:this.state.tagGroupsToTags,onMoveTagToGroup:t=>this.onTagMove(e,t),onChanged:t=>this.onTagChanged(e,t)}))))))))),h.createElement(E,{eventKey:"groups",title:"Groups"},this.state.loading&&h.createElement(T,null),h.createElement("div",{className:"row"},!this.state.loading&&(null===(t=this.state.tagGroups)||void 0===t?void 0:t.map(e=>h.createElement("div",{className:"col-sm-12 col-md-6 col-lg-4"},h.createElement(u.default,{item:e,onUp:()=>this.onGroupUp(e),onDown:()=>this.onGroupDown(e),onRemove:()=>this.onGroupRemove(e),onChanged:(t,n)=>this.onGroupChanged(e,t,n)}))))),!this.state.loading&&h.createElement("div",null,h.createElement(m,{variant:"primary",onClick:this.onGroupAdd},"Add")))))}}t.default=C}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,n),a.exports}n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};n(221)})();